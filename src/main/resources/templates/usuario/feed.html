<script>
	//falta que cuando se comente se carguen los comentarios
	function leer(objeto) {

		objeto.parentNode.parentNode.children[1].style.height = "auto";

		objeto.text = "Leer menos";

		objeto.onclick = function () {
			objeto.parentNode.parentNode.children[1].style.height = "200px";
			objeto.text = "Leer m�s";
			objeto.onclick = function () {
				leer(objeto)
			};

		};
	}

//Waves

	/*window.onload = function(){
		
		$(document).ready(function(){
			$.ajax({
				url: "",
				type: "get",
				success
				
			});
		});
		
	}*/

	function wave(w) {

		console.log(w.nextSibling.nextSibling.firstChild);
		if (w.checked == true) {
			w.nextSibling.nextSibling.firstChild.src = "./img/sub.png";
			var parametros = {
				"wave": w.value
			}
			$(document).ready(function () {
				$.ajax({
					data: parametros, //datos que se envian a traves de ajax
					url: '/crearWave', //archivo que recibe la peticion
					type: 'post', //método de envio

				});
			});

		} else {

			w.nextSibling.nextSibling.firstChild.src = "./img/unsub.png";
			var parametros = {
				"wave": w.value,

			}
			$(document).ready(function () {
				$.ajax({
					data: parametros, //datos que se envian a traves de ajax
					url: '/borrarWave', //archivo que recibe la peticion
					type: 'post', //método de envio
					
				});
			});

		}

	}

//Comentarios

	function verComentarios(div) {
		console.log("var div");
		console.log(div);
		console.log("DIV REAL");
		console.log(div.parentNode.parentNode.previousSibling.previousSibling);
		var divReal = div.parentNode.parentNode.previousSibling.previousSibling;

		$(document).ready(function () {

			/*var parametros = {
				"idPublicacion": idPublicacion,
			}*/

			$.ajax({
				url: "/verComentarios",
				type: "get",
				success: function (comentarios) {
					console.log(comentarios);
					divReal.innerHTML=comentarios;

				}

			});
		});
	}

	function comentar(btn) {
		var comentario = btn.previousSibling.previousSibling.previousSibling.previousSibling.value;
		btn.previousSibling.previousSibling.previousSibling.previousSibling.value = "";
		
		var idPublicacion = btn.previousSibling.previousSibling.value;
		
		var divReal = btn.parentNode.parentNode.previousSibling.previousSibling;


		var parametros = {
			"comentario": comentario,
			"idPublicacion": idPublicacion
		}
		$(document).ready(function () {

			$.ajax({
				data: parametros,
				url: "/crearComentario",
				type: "post",
				success: function (comentarios) {
					console.log(comentarios);
					divReal.innerHTML=comentarios;

				}

			});
		});


	}
	
	//Comentarios
</script>
<div class="col-lg">
	<div id="centro" class=" justify-content-center align-items-center">
		<!-- 			cargar publicaciones -->
		<div th:each="publicacion: ${publicaciones}">
			<div id="perfiles">
				<div id="borde-perfil" class="d-flex justify-content-center align-items-center">

					<div class="card card-feed d-flex justify-content-center align-items-center">


						<!-- 				img solo desde static -->
						<div th:if="${publicacion.tipoContenido}=='img'">
							<img class="card-img feed-img" th:src="@{${publicacion.contenido}}">
						</div>

						<!-- 		Para video -->
						<div th:if="${publicacion.tipoContenido}=='video'" class="card-film feed-film">
							<video width="500px" height="300px" controls>
								<source th:src="@{${publicacion.contenido}}" type="video/mp4" />
							</video>
						</div>



						<div th:if="${publicacion.tipoContenido}=='audio'" class="card-audio feed-audio">
							<audio th:src="@{${publicacion.contenido}}" controls type="audio/mpeg">
							</audio>
						</div>


						<div class="col-md-12">
							<div class="card-body feed-body">
								<div class="card-tittle feed-tittle">
									<b th:text="${publicacion.duenioPublicacion.loginName}">Nombre</b>
								</div>
								<div class="card-text feed-text">
									<p th:id="${publicacion.id}" th:text="${publicacion.descripcion}"></p>
									<p class="text-muted text-right" id="fecha"
										th:text="${publicacion.fechaPublicacion}"></p>
								</div>
								<div class="leer-mas">
									<a class="leer" onclick="leer(this)">Leer m�s</a>
								</div>
								<div class="card-footer text-right">
									<div class="icons">
										<input type="checkbox" th:id="|wave-${publicacion.id}|"
											th:value="${publicacion.id}" style="display: none;" onchange="wave(this)" />
										<label th:for="|wave-${publicacion.id}|"><img src="./img/unsub.png" /></label>
									</div>


									<div id="|coment-${publicacion.id}|">
									</div>
									
									<div class="form-group">
										<div class="d-flex pt-4 comentarios">
											<img class="foto-perfil col-2"
												th:src="@{${publicacion.duenioPublicacion.fotoPerfil}}">
											<input type="text" class="form-control col-4" placeholder="Comentar"
												name="comentario" id="comentario" />
											<input type="hidden" th:value="${publicacion.id}" />
											<input type="button" class="btn btn-info btn-sm" value="Comentar"
												onClick="comentar(this)" />
											<input type="button" class="btn btn-info btn-sm" value="Ver Comentarios"
												onClick="verComentarios(this)" />
										</div>
									</div>
									<!--Comentarios -->


								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>